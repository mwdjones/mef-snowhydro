ylim(c(min(forestInv_sum$EASTING) - 50, max(forestInv_sum$EASTING) + 50)) +
facet_wrap("SPECIES") +
guides(x =  guide_axis(angle = -45), size = guide_legend(title = "Species Count")) +
labs(x = "Northing", y = "Easting",
title = "Spatial Distribution of Tree Species in S2") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20),
legend.box.background = element_rect(fill = NA)
)
#Species abundance
ggplot(data = forestInv_sum, aes(x = NORTHING, y = EASTING, size = n)) +
geom_point(shape = 1, color = 'Red') +
xlim(c(min(forestInv_sum$NORTHING) - 50, max(forestInv_sum$NORTHING) + 50)) +
ylim(c(min(forestInv_sum$EASTING) - 50, max(forestInv_sum$EASTING) + 50)) +
facet_wrap("SPECIES") +
guides(x =  guide_axis(angle = -45), size = guide_legend(title = "Species Count")) +
labs(x = "Northing", y = "Easting",
title = "Spatial Distribution of Tree Species in S2") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20),
legend.background =  = element_rect(fill = NA)
#Species abundance
ggplot(data = forestInv_sum, aes(x = NORTHING, y = EASTING, size = n)) +
geom_point(shape = 1, color = 'Red') +
xlim(c(min(forestInv_sum$NORTHING) - 50, max(forestInv_sum$NORTHING) + 50)) +
ylim(c(min(forestInv_sum$EASTING) - 50, max(forestInv_sum$EASTING) + 50)) +
facet_wrap("SPECIES") +
guides(x =  guide_axis(angle = -45), size = guide_legend(title = "Species Count")) +
labs(x = "Northing", y = "Easting",
title = "Spatial Distribution of Tree Species in S2") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20),
legend.background = element_rect(fill = NA)
)
#Species abundance
ggplot(data = forestInv_sum, aes(x = NORTHING, y = EASTING, size = n)) +
geom_point(shape = 1, color = 'Red') +
xlim(c(min(forestInv_sum$NORTHING) - 50, max(forestInv_sum$NORTHING) + 50)) +
ylim(c(min(forestInv_sum$EASTING) - 50, max(forestInv_sum$EASTING) + 50)) +
facet_wrap("SPECIES") +
guides(x =  guide_axis(angle = -45), size = guide_legend(title = "Species Count")) +
labs(x = "Northing", y = "Easting",
title = "Spatial Distribution of Tree Species in S2") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM, fill = Zone)) +
geom_histogram(stat = "count", position = "stack") +
guides(x =  guide_axis(angle = -45)) +
scale_fill_pomological() +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_histogram(stat = "count") +
guides(x =  guide_axis(angle = -45)) +
scale_fill_pomological() +
facet_wrap("Zone") +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_histogram(stat = "count") +
guides(x =  guide_axis(angle = -45)) +
scale_fill_pomological() +
facet_wrap(Zone) +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_histogram(stat = "count") +
facet_wrap("Zone") +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#Summarize the data by species and locations
forestInv_sum = forestInv %>%
count(NORTHING, EASTING, SPECIES, sort = TRUE)
head(forestInv_sum)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_histogram(stat = "count") +
facet_wrap("SPECIES") +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_histogram(stat = "count") +
facet_wrap("SPECIES") +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_wrap("SPECIES") +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_wrap("Zone") +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_grid(x = "Zone", y = "CC") +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_grid(x = vars(Zone), y = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_grid(rows = vars(Zone), cols = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(Zone), rows = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
forestInv = readxl::read_excel('./Cleaned Data/S2overstory_2023_compiled.xlsx',
na = c('NAN'))
head(forestInv)
unique(forestInv$SPECIES)
#Sort into peatland zones
forestInv = forestInv %>%
mutate(Zone = ifelse(SITE %in% c('S213', 'S221', 'S222', 'S223', 'S233', 'S234'), "Bog",
ifelse(SITE %in% c('S211', 'S212', 'S224', 'S225', 'S232', 'S235'),
"Lagg", "Upland")))
head(forestInv)
ggplot(data = forestInv, aes(x = SPECIES, fill = Zone)) +
geom_histogram(stat = "count", position = "stack") +
guides(x =  guide_axis(angle = -45)) +
scale_fill_pomological() +
labs(x = " ", y = "Counts",
title = "Species Abundance by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(Zone), rows = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv[!is.na(forestInv$CC)], aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(Zone), rows = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = forestInv[!is.na(forestInv)], aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(Zone), rows = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = na.omit(forestInv), aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(Zone), rows = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = na.omit(forestInv), aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(factor(Zone, levels = c("Dom", "Co", "Int", "Sup")),
rows = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = na.omit(forestInv), aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(factor(Zone, levels = c("Dom", "Co", "Int", "Sup"))),
rows = vars(CC)) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = na.omit(forestInv), aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(Zone),
rows = vars(factor(CC, levels = c("Dom", "Co", "Int", "Sup")))) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "Highest diversity in the uplands with Black Spruce dominating the bog.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
ggplot(data = na.omit(forestInv), aes(x = DBH_CM)) +
geom_density() +
facet_grid(cols = vars(Zone),
rows = vars(factor(CC, levels = c("Dom", "Co", "Int", "Sup")))) +
labs(x = " ", y = "Counts",
title = "Tree Width by Peatland Zone",
subtitle = "High number of small trees in bog versus fewer but larger trees in uplands.") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#Summarize the data by species and locations
forestInv_sum = forestInv %>%
count(NORTHING, EASTING, SPECIES, sort = TRUE)
head(forestInv_sum)
#Species abundance
ggplot(data = forestInv_sum, aes(x = NORTHING, y = EASTING, size = n)) +
geom_point(shape = 1, color = 'Red') +
xlim(c(min(forestInv_sum$NORTHING) - 50, max(forestInv_sum$NORTHING) + 50)) +
ylim(c(min(forestInv_sum$EASTING) - 50, max(forestInv_sum$EASTING) + 50)) +
facet_wrap("SPECIES") +
guides(x =  guide_axis(angle = -45), size = guide_legend(title = "Species Count")) +
labs(x = "Northing", y = "Easting",
title = "Spatial Distribution of Tree Species in S2") +
theme(strip.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#Bin Easting and Northing data for plotting in "map like" layout
forestInv$eastingBin = floor(ave(forestInv$EASTING,
cut(forestInv$EASTING,
breaks = c(min(forestInv_binned$EASTING)-10, 5262500, 5262450, 5262400, 5262350, 5262250, max(forestInv_binned$EASTING)+10)),
FUN = mean))
forestInv$eastingBin_f = factor(forestInv$eastingBin, levels = c(5262531, 5262487, 5262424, 5262363, 5262309,5262240))
forestInv$northingBin = floor(ave(forestInv$NORTHING,
cut(forestInv$NORTHING,
breaks = 7),
FUN = mean))
forestInv
#DBH distribution
ggplot(data = forestInv, aes(x = DBH_CM)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
labs(x = "Distance from Plot Center (m)",
y = "Frequency",
title = "Diameter at Breast Height Distributions in S2",
subtitle = "Diversity of tree width is higher in the upland regions than in the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DIST_M)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
labs(x = "Distance from Plot Center (m)", y  = "Frequency",
title = "Distance from Plot Center Distribution in S2",
subtitle = "Higher numbers of trees on the south facing slope skew visual results") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DBH_CM, color = Zone)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
labs(x = "Distance from Plot Center (m)",
y = "Frequency",
title = "Diameter at Breast Height Distributions in S2",
subtitle = "Diversity of tree width is higher in the upland regions than in the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DBH_CM, color = Zone)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
scale_color_pomological() +
labs(x = "Distance from Plot Center (m)",
y = "Frequency",
title = "Diameter at Breast Height Distributions in S2",
subtitle = "Diversity of tree width is higher in the upland regions than in the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DBH_CM, color = Zone, fill = Zone)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
scale_color_pomological() +
labs(x = "Distance from Plot Center (m)",
y = "Frequency",
title = "Diameter at Breast Height Distributions in S2",
subtitle = "Diversity of tree width is higher in the upland regions than in the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DBH_CM, color = Zone, fill = Zone)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
scale_color_pomological() +
scale_fill_pomological() +
labs(x = "Distance from Plot Center (m)",
y = "Frequency",
title = "Diameter at Breast Height Distributions in S2",
subtitle = "Diversity of tree width is higher in the upland regions than in the bog.") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DIST_M, color = Zone, fill = Zone)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
scale_color_pomological() +
scale_fill_pomological() +
labs(x = "Distance from Plot Center (m)", y  = "Frequency",
title = "Distance from Plot Center Distribution in S2",
subtitle = "Higher numbers of trees on the south facing slope skew visual results") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DIST_M, color = Zone, fill = NA)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
scale_color_pomological() +
scale_fill_pomological() +
labs(x = "Distance from Plot Center (m)", y  = "Frequency",
title = "Distance from Plot Center Distribution in S2",
subtitle = "Higher numbers of trees on the south facing slope skew visual results") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#DBH distribution
ggplot(data = forestInv, aes(x = DIST_M, color = Zone, fill = Zone)) +
geom_density() +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
scale_color_pomological() +
scale_fill_pomological() +
labs(x = "Distance from Plot Center (m)", y  = "Frequency",
title = "Distance from Plot Center Distribution in S2",
subtitle = "Higher numbers of trees on the south facing slope skew visual results") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
plot.title=element_text(face="bold", size=20)
)
#Species distribution
ggplot(data = forestInv, aes(x = "", y = SPECIES, fill = SPECIES)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar("y", start=0) +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
labs(x = "Species of Tree",
y = "Frequency",
title = "Distribution of Tree Species in S2",
subtitle = " ") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
axis.text = element_blank(),
plot.title=element_text(face="bold", size=20)
)
#Summarize the data by species and locations
forestInv_binsum = forestInv_binned %>%
count(northingBin, eastingBin, SPECIES, sort = TRUE)
head(forestInv_binsum)
#Species distribution
ggplot(data = forestInv, aes(x = "", y = SPECIES, fill = SPECIES)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar("y", start=0) +
facet_grid(rows = vars(eastingBin_f), cols = vars(northingBin)) +
labs(x = "Species of Tree",
y = "Frequency",
title = "Distribution of Tree Species in S2",
subtitle = " ") +
theme(strip.background = element_blank(),
strip.text = element_blank(),
panel.background = element_blank(),
panel.grid = element_line(colour = 'grey92'),
axis.text = element_blank(),
plot.title=element_text(face="bold", size=20)
)
